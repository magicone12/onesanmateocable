<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:Arial, sans-serif;
}

/* ===== FIXED PLAYER ===== */
.playerFixed {
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  max-width: 1000px;
  z-index: 10000;
  background: #000;
  border-radius: 10px;
}

.videoWrap {
  width: 100%;
  aspect-ratio: 16/9;
  border-radius: 10px;
  overflow: hidden;
  position: relative;
}

video {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: #000;
}

/* ===== PLAYER CONTROLS ===== */
.controlsOverlay{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:flex-end;
  align-items:flex-start;
  padding:10px;
  gap:8px;
  pointer-events:none;
  opacity:0;
  transition:.25s;
}
.controlsOverlay.show{opacity:1; pointer-events:auto;}

.ctrlBtn{
  background:rgba(0,0,0,.6);
  border:1px solid rgba(255,255,255,.2);
  color:#fff;
  padding:6px 10px;
  border-radius:6px;
  font-size:12px;
  cursor:pointer;
}

/* ===== CHANNEL BUTTONS ===== */
.buttonsFixed{
  position: relative;
  max-width:1000px;
  margin:0 auto;
  padding:10px;
  display:flex;
  gap:10px;
  z-index:998;
  top: calc((100vw * 9 / 16) + 20px); /* player height + spacing */
}

.buttonsFixed button{
  flex:1;
  padding:15px;
  border:none;
  border-radius:8px;
  background:#2b2b2b;
  color:#fff;
  cursor:pointer;
}

/* ===== CHANNEL LISTS ===== */
.channelPanelFixed{
  position: relative;
  max-width:1000px;
  margin:10px auto;
  background:#1e1e1e;
  border-radius:12px;
  padding:10px;
  display:none;
  z-index:997;
  max-height:50vh;
  overflow-y:auto;
}

.channelPanelFixed h3{
  margin:0 0 10px;
  text-align:center;
  position:sticky;
  top:0;
  background:#00e1ff;
  color:#000;
  padding:10px 0;
}

.channel{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px;
  margin-bottom:6px;
  background:#2b2b2b;
  border-radius:6px;
  cursor:pointer;
}

.channel img{
  width:60px;
  height:36px;
  object-fit:contain;
}

.chName{
  flex:1;
  text-align:center;
}

/* ===== LOADING ===== */
.loading{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  background:rgba(0,0,0,.4);
  pointer-events:none;
  opacity:0;
  transition:.2s;
}

/* ===== MOBILE ===== */
@media (max-width: 768px){
  .playerFixed {
    width: 95%;
    max-width: 500px;
    top: 10px;
  }

  .buttonsFixed, .channelPanelFixed {
    top: 0;
    margin-top: calc((95vw * 9 / 16) + 20px);
  }
}
</style>
</head>

<body>

<div class="playerFixed" id="playerBox">
  <div class="videoWrap" id="videoWrap">
    <video id="video" autoplay playsinline></video>
    <div class="loading" id="loadingTxt">Loading channelâ€¦</div>
    <div class="controlsOverlay" id="controls">
      <button class="ctrlBtn" id="fsBtn">FULL</button>
      <button class="ctrlBtn" id="wideBtn">WIDE</button>
      <button class="ctrlBtn" id="fitBtn">FIT</button>
    </div>
  </div>
</div>

<div class="buttonsFixed" id="buttonsBar">
  <button onclick="toggleList('main')">AFFILIATE TV</button>
  <button onclick="toggleList('second')">SAN MATEO CABLE</button>
</div>

<div class="channelPanelFixed" id="panelMain">
  <h3>AFFILIATE TV</h3>
  <div id="mainList"></div>
</div>

<div class="channelPanelFixed" id="panelSecond">
  <h3>SAN MATEO CABLE</h3>
  <div id="secondList"></div>
</div>

<div class="spacer" style="height:2000px;"></div>

<script>
/* ===== SAMPLE CHANNELS ===== */
const mainChannels = [
  {name:"GOLDEN TV", logo:"https://i.imgur.com/urWAPgv.png", src:"https://long-hall-41fd.ostamark484.workers.dev", type:"hls"},
  {name:"SDTV", logo:"https://i.imgur.com/PfJ0jVP.png", src:"https://live20.bozztv.com/giatvplayout7/giatv-210938/tracks-v1a1/mono.ts.m3u8", type:"hls"}
];

const secondChannels = [
  {name:"KAPAMILYA CHANNEL", logo:"https://i.imgur.com/fRETRXx.png", src:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/54afaecb-9608-4827-a19a-e1a2d2f498d5/index.mpd", type:"mpd"}
];

/* ===== BUILD CHANNEL LISTS ===== */
function build(list, el){
  el.innerHTML="";
  list.forEach((ch,i)=>{
    const row=document.createElement("div");
    row.className="channel";
    const img=document.createElement("img");
    img.src=ch.logo || "https://via.placeholder.com/60x36";
    const sp=document.createElement("span");
    sp.className="chName";
    sp.textContent=(i+1)+". "+ch.name;
    row.appendChild(img);
    row.appendChild(sp);
    row.onclick=()=>playChannel(ch);
    el.appendChild(row);
  });
}
build(mainChannels, document.getElementById("mainList"));
build(secondChannels, document.getElementById("secondList"));

/* ===== TOGGLE LIST ===== */
function toggleList(type){
  document.getElementById("panelMain").style.display = (type==="main") ? 
    (document.getElementById("panelMain").style.display==="block"?"none":"block") : "none";
  document.getElementById("panelSecond").style.display = (type==="second") ? 
    (document.getElementById("panelSecond").style.display==="block"?"none":"block") : "none";
}

/* ===== VIDEO PLAYER ===== */
shaka.polyfill.installAll();
const video=document.getElementById("video");
const player=new shaka.Player(video);

async function playChannel(ch){
  if(!ch.src) return;
  try{ await player.unload(); }catch(e){}
  video.muted=false;

  if(ch.type==="mpd"){
    player.load(ch.src);
  }
  if(ch.type==="hls"){
    if(video.canPlayType("application/vnd.apple.mpegurl")){
      video.src=ch.src;
      video.play().catch(()=>{});
    } else if(Hls.isSupported()){
      const hls=new Hls();
      hls.attachMedia(video);
      hls.loadSource(ch.src);
    }
  }
}

/* ===== CONTROLS ===== */
document.getElementById("fitBtn").onclick  = ()=> video.style.objectFit="contain";
document.getElementById("wideBtn").onclick = ()=> video.style.objectFit="cover";
document.getElementById("fsBtn").onclick   = ()=> {
  if(!document.fullscreenElement){
    document.getElementById("videoWrap").requestFullscreen?.();
  }else{
    document.exitFullscreen?.();
  }
};
</script>

</body>
</html>
