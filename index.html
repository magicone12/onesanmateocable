<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>San Mateo Cable</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
body {
  margin:0;
  background:#111;
  color:#fff;
  font-family:Arial,sans-serif;
  overflow-x:hidden;
}

/* ===== PLAYER ===== */
.playerFixed {
  position:fixed;
  top:0;
  left:0;
  width:100%;
  max-width:1000px;
  margin:auto;
  z-index:1000;
}

.videoWrap {
  width:100%;
  aspect-ratio:16/9;
  background:#000;
  overflow:hidden;
  position:relative;
}

video {
  width:100%;
  height:100%;
  object-fit:contain;
  background:#000;
}

/* CONTROLS */
.controlsOverlay {
  position:absolute;
  inset:0;
  display:flex;
  justify-content:flex-end;
  align-items:flex-start;
  padding:10px;
  gap:8px;
  pointer-events:none;
  opacity:0;
  transition:.25s;
}
.controlsOverlay.show { opacity:1; pointer-events:auto; }
.ctrlBtn {
  background:rgba(0,0,0,.6);
  border:1px solid rgba(255,255,255,.2);
  color:#fff;
  padding:6px 10px;
  border-radius:6px;
  font-size:12px;
  cursor:pointer;
}

/* LOADING */
.loading {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  background:rgba(0,0,0,.4);
  pointer-events:none;
  opacity:0;
  transition:.2s;
}

/* CHANNEL PANEL */
.channelPanelFixed {
  position:fixed;
  top:0;
  right:0;
  width:80%;
  max-width:350px;
  height:100vh;
  background:#1e1e1e;
  padding:10px;
  z-index:1001;
  overflow-y:auto;
  box-shadow: -5px 0 15px rgba(0,0,0,.5);
}

.channelPanelFixed h3 {
  margin:0 0 10px;
  padding:15px 0;
  text-align:center;
  background:#00e1ff;
  color:#000;
  position:sticky;
  top:0;
}

.channel {
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px;
  margin-bottom:6px;
  background:#2b2b2b;
  border-radius:6px;
  cursor:pointer;
}

.channel img {
  width:60px;
  height:36px;
  object-fit:contain;
}

.chName { flex:1; text-align:center; }

/* ===== MOBILE ===== */
@media(max-width:768px){
  .playerFixed { width:95%; }
  .channelPanelFixed { width:90%; max-width:300px; }
}
</style>
</head>
<body>

<div class="playerFixed" id="playerBox">
  <div class="videoWrap" id="videoWrap">
    <video id="video" autoplay playsinline></video>
    <div class="loading" id="loadingTxt">Loading channelâ€¦</div>
    <div class="controlsOverlay" id="controls">
      <button class="ctrlBtn" id="fsBtn">FULL</button>
      <button class="ctrlBtn" id="wideBtn">WIDE</button>
      <button class="ctrlBtn" id="fitBtn">FIT</button>
    </div>
  </div>
</div>

<div class="channelPanelFixed" id="panelSanMateo">
  <h3>SAN MATEO CABLE</h3>
  <div id="sanMateoList"></div>
</div>

<script>
shaka.polyfill.installAll();
const video = document.getElementById("video");
const player = new shaka.Player(video);
let hlsPlayer=null;
let lastChannel=null;

/* SAN MATEO CABLE CHANNELS */
const sanMateoChannels = [
  {name:"KAPAMILYA CHANNEL",logo:"https://i.imgur.com/fRETRXx.png",src:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/54afaecb-9608-4827-a19a-e1a2d2f498d5/index.mpd",type:"mpd"},
  {name:"SOME OTHER CHANNEL",logo:"https://i.imgur.com/placeholder.png",src:"https://example.com/stream.m3u8",type:"hls"}
];

/* BUILD CHANNEL LIST */
function build(list, el){
  el.innerHTML="";
  list.forEach((ch,i)=>{
    const row=document.createElement("div");
    row.className="channel";
    const img=document.createElement("img"); img.src=ch.logo||"https://via.placeholder.com/60x36";
    const sp=document.createElement("span"); sp.className="chName"; sp.textContent=(i+1)+". "+ch.name;
    row.appendChild(img); row.appendChild(sp);
    row.onclick=()=>playChannel(ch);
    el.appendChild(row);
  });
}
build(sanMateoChannels, document.getElementById("sanMateoList"));

/* PLAYER CONTROLS */
document.getElementById("fitBtn").onclick  = ()=> video.style.objectFit="contain";
document.getElementById("wideBtn").onclick = ()=> video.style.objectFit="cover";
document.getElementById("fsBtn").onclick   = ()=> {
  if(!document.fullscreenElement) document.getElementById("videoWrap").requestFullscreen?.();
  else document.exitFullscreen?.();
}

/* PLAY CHANNEL */
async function playChannel(ch){
  if(!ch.src) return;
  lastChannel=ch;

  try{ await player.unload(); }catch(e){}
  video.muted=false;

  if(ch.type==="mpd"){
    player.load(ch.src).catch(()=>setTimeout(()=>playChannel(ch),3000));
  }
  if(ch.type==="hls"){
    if(video.canPlayType("application/vnd.apple.mpegurl")){
      video.src=ch.src; video.play().catch(()=>{});
    }else if(Hls.isSupported()){
      if(hlsPlayer) hlsPlayer.destroy();
      hlsPlayer=new Hls();
      hlsPlayer.attachMedia(video);
      hlsPlayer.loadSource(ch.src);
      hlsPlayer.on(Hls.Events.MANIFEST_PARSED,()=>video.play().catch(()=>{}));
    }
  }
}
</script>

</body>
</html>
