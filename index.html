<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>San Mateo Cable</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
body {
  margin:0;
  background:#000;
  overflow:hidden;
  font-family:Arial,sans-serif;
}

/* FULLSCREEN PLAYER */
.playerWrapper {
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#000;
}

video {
  width:90%;
  max-width:1000px;
  height:90%;
  object-fit:contain; /* FIT SCREEN */
  background:#000;
  cursor:pointer;
  display:block;
}

/* CHANNEL PANEL SLIDE-IN */
.channelPanelFixed {
  position:fixed;
  top:0;
  right:-100%;
  width:300px;
  max-width:80%;
  height:100vh;
  background:#1e1e1e;
  padding:10px;
  z-index:1001;
  overflow-y:auto;
  transition:right .3s ease-in-out;
  box-shadow:-5px 0 15px rgba(0,0,0,.5);
}

.channelPanelFixed.show {
  right:0;
}

.channelPanelFixed h3 {
  margin:0 0 10px;
  padding:15px 0;
  text-align:center;
  background:#00e1ff;
  color:#000;
  position:sticky;
  top:0;
}

.channel {
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px;
  margin-bottom:6px;
  background:#2b2b2b;
  border-radius:6px;
  cursor:pointer;
}

.channel img {
  width:60px;
  height:36px;
  object-fit:contain;
}

.chName { flex:1; text-align:center; }
</style>
</head>
<body>

<div class="playerWrapper" id="playerWrapper">
  <video id="video" autoplay playsinline></video>
</div>

<div class="channelPanelFixed" id="channelPanel">
  <h3>SAN MATEO CABLE</h3>
  <div id="channelList"></div>
</div>

<script>
shaka.polyfill.installAll();
const video = document.getElementById("video");
const player = new shaka.Player(video);
let hlsPlayer=null;
let lastChannel=null;

/* SAN MATEO CABLE CHANNELS */
const channels = [
  {name:"KAPAMILYA CHANNEL",logo:"https://i.imgur.com/fRETRXx.png",src:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/54afaecb-9608-4827-a19a-e1a2d2f498d5/index.mpd",type:"mpd"},
  {name:"GOLDEN TV",logo:"https://i.imgur.com/urWAPgv.png",src:"https://long-hall-41fd.ostamark484.workers.dev",type:"hls"}
];

/* BUILD CHANNEL LIST */
function buildList(){
  const el=document.getElementById("channelList");
  el.innerHTML="";
  channels.forEach((ch,i)=>{
    const row=document.createElement("div");
    row.className="channel";
    const img=document.createElement("img"); img.src=ch.logo||"https://via.placeholder.com/60x36";
    const sp=document.createElement("span"); sp.className="chName"; sp.textContent=(i+1)+". "+ch.name;
    row.appendChild(img); row.appendChild(sp);
    row.onclick=()=>{ playChannel(ch); togglePanel(false); };
    el.appendChild(row);
  });
}
buildList();

/* TOGGLE PANEL */
const panel = document.getElementById("channelPanel");
function togglePanel(show){
  if(show) panel.classList.add("show");
  else panel.classList.remove("show");
}

/* CLICK VIDEO TO SHOW/HIDE CHANNEL LIST */
video.onclick = ()=> {
  panel.classList.toggle("show");
}

/* PLAY CHANNEL */
async function playChannel(ch){
  if(!ch.src) return;
  lastChannel=ch;
  try{ await player.unload(); }catch(e){}
  video.muted=false;

  if(ch.type==="mpd"){
    player.load(ch.src).catch(()=>setTimeout(()=>playChannel(ch),3000));
  }
  if(ch.type==="hls"){
    if(video.canPlayType("application/vnd.apple.mpegurl")){
      video.src=ch.src; video.play().catch(()=>{});
    }else if(Hls.isSupported()){
      if(hlsPlayer) hlsPlayer.destroy();
      hlsPlayer=new Hls();
      hlsPlayer.attachMedia(video);
      hlsPlayer.loadSource(ch.src);
      hlsPlayer.on(Hls.Events.MANIFEST_PARSED,()=>video.play().catch(()=>{}));
    }
  }
}

/* AUTO FULLSCREEN & PLAY FIRST CHANNEL ON LOAD */
window.onload = async ()=>{
  playChannel(channels[0]);
  if (video.requestFullscreen) {
    await video.requestFullscreen();
  } else if (video.webkitRequestFullscreen) {
    video.webkitRequestFullscreen();
  }
};
</script>

</body>
</html>
